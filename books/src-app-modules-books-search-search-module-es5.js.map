{"version":3,"sources":["webpack:///src/app/modules/books/search/search-routing.module.ts","webpack:///src/app/modules/books/search/search.module.ts","webpack:///src/app/modules/books/search/search/book-details/book-details.component.ts","webpack:///src/app/modules/books/search/search/book-details/book-details.component.html","webpack:///src/app/modules/books/search/search/books-search-input/books-search-input.component.ts","webpack:///src/app/modules/books/search/search/books-search-input/books-search-input.component.html","webpack:///src/app/modules/books/search/search/books-table/books-table.component.ts","webpack:///src/app/modules/books/search/search/books-table/books-table.component.html","webpack:///src/app/modules/books/search/search/search.component.ts","webpack:///src/app/modules/books/search/search/search.component.html","webpack:///src/app/modules/books/store/selectors/search.selectors.ts"],"names":["routes","path","component","SearchRoutingModule","forChild","imports","exports","SearchModule","declarations","entryComponents","BookDetailsComponent","data","book","templateUrl","styleUrls","BooksSearchInputComponent","inputChange","inputEl","nativeElement","pipe","x","value","emit","subscribe","selector","rowClicked","BooksTableComponent","pageChange","totalItems","columns","pageSize","destroy$","totalItems$","paginator","firstPage","$event","pageIndex","next","onPaginateChange","SearchComponent","store","dialog","username$","select","loading$","books$","lastQuery","searchBooks","startIndex","query","dispatch","dialogRef","open","width","maxHeight","afterClosed","result","onSearchInputChanged","onPageChange","onRowClicked","changeDetection","OnPush","selectSearchState","searchLoading","state","loading","books"],"mappings":"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","file":"src-app-modules-books-search-search-module-es5.js","sourcesContent":["import { SearchComponent } from './search/search.component';\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SearchComponent,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SearchRoutingModule {}\n","import { MatCoreModule } from './../../../shared/mat-core/mat-core.module';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { SearchRoutingModule } from './search-routing.module';\nimport { SearchComponent } from './search/search.component';\nimport { BooksSearchInputComponent } from './search/books-search-input/books-search-input.component';\nimport { BooksTableComponent } from './search/books-table/books-table.component';\nimport { BookDetailsComponent } from './search/book-details/book-details.component';\n\n@NgModule({\n  declarations: [\n    BooksTableComponent,\n    BooksSearchInputComponent,\n    SearchComponent,\n    BookDetailsComponent,\n  ],\n  imports: [CommonModule, SearchRoutingModule, MatCoreModule],\n  entryComponents: [BookDetailsComponent],\n})\nexport class SearchModule {}\n","import { Component, Inject, OnInit } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { Book } from 'src/app/core/models/book.model';\n\n@Component({\n  templateUrl: './book-details.component.html',\n  styleUrls: ['./book-details.component.scss'],\n})\nexport class BookDetailsComponent implements OnInit {\n  book: Book;\n\n  constructor(@Inject(MAT_DIALOG_DATA) data: Book) {\n    this.book = data;\n  }\n\n  ngOnInit(): void {}\n}\n","<h1 mat-dialog-title>{{ book.title }}</h1>\n<div mat-dialog-content style=\"overflow: hidden\">\n  <div class=\"row\">\n    <div class=\"col-auto\"><img [src]=\"book.thumbnailUrl\" /></div>\n    <div class=\"col\">{{ book.description }}</div>\n  </div>\n</div>\n<div mat-dialog-actions>\n  <button mat-button [mat-dialog-close]=\"false\">Close</button>\n  <button mat-button [mat-dialog-close]=\"true\" cdkFocusInitial>\n    Add to wishlist\n  </button>\n</div>\n","import {\n  Component,\n  OnInit,\n  ViewChild,\n  ElementRef,\n  AfterViewInit,\n  Output,\n  OnDestroy,\n  EventEmitter,\n  Input,\n} from '@angular/core';\nimport { fromEvent } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-books-search-input',\n  templateUrl: './books-search-input.component.html',\n  styleUrls: ['./books-search-input.component.scss'],\n})\nexport class BooksSearchInputComponent\n  implements OnInit, AfterViewInit, OnDestroy {\n  @ViewChild('input') inputEl: ElementRef;\n\n  @Output() inputChange = new EventEmitter<string>();\n\n  constructor() {}\n\n  ngOnInit(): void {}\n\n  ngAfterViewInit(): void {\n    fromEvent(this.inputEl.nativeElement, 'input')\n      .pipe(\n        map((x: any) => {\n          const value = this.inputEl.nativeElement.value;\n          this.inputChange.emit(value);\n        })\n      )\n      .subscribe(() => {});\n  }\n\n  ngOnDestroy(): void {}\n}\n","<mat-form-field>\n  <input #input matInput placeholder=\"Search books\" />\n</mat-form-field>\n","import { Observable, Subject } from 'rxjs';\nimport {\n  Component,\n  EventEmitter,\n  Input,\n  OnDestroy,\n  OnInit,\n  Output,\n  ViewChild,\n} from '@angular/core';\nimport { Book } from 'src/app/core/models/book.model';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-books-table',\n  templateUrl: './books-table.component.html',\n  styleUrls: ['./books-table.component.scss'],\n})\nexport class BooksTableComponent implements OnInit, OnDestroy {\n  @Input() books$: Observable<Book>;\n  @Input() totalItems$: Observable<number>;\n  @Input() loading$: Observable<boolean>;\n  @Output() pageChange = new EventEmitter<{\n    pageIndex: number;\n    pageSize: number;\n  }>();\n  @Output() rowClicked = new EventEmitter<Book>();\n\n  totalItems = 0;\n\n  // Table properties\n  columns = ['title'];\n  pageSize = 20;\n  @ViewChild('paginator') paginator: MatPaginator;\n\n  destroy$ = new Subject();\n\n  constructor() {}\n\n  ngOnInit(): void {\n    // Reset paginator on new query\n    this.totalItems$.pipe(takeUntil(this.destroy$)).subscribe((x) => {\n      if (this.paginator) {\n        this.paginator.firstPage();\n      }\n\n      this.totalItems = x;\n    });\n  }\n\n  onPaginateChange($event) {\n    this.pageChange.emit({\n      pageIndex: $event.pageIndex,\n      pageSize: $event.pageSize,\n    });\n  }\n\n  ngOnDestroy(): void {\n    this.destroy$.next();\n  }\n}\n","<div div class=\"mat-elevation-z8\">\n  <table mat-table [dataSource]=\"books$ | async\">\n    <ng-container matColumnDef=\"title\">\n      <th mat-header-cell *matHeaderCellDef>Title</th>\n      <td mat-cell *matCellDef=\"let element\">{{ element.title }}</td>\n    </ng-container>\n\n    <tr mat-header-row *matHeaderRowDef=\"columns\"></tr>\n    <tr\n      class=\"clickable-row\"\n      mat-row\n      *matRowDef=\"let row; columns: columns\"\n      (click)=\"rowClicked.emit(row)\"\n    ></tr>\n  </table>\n  <mat-paginator\n    #paginator\n    [length]=\"totalItems\"\n    [pageSize]=\"pageSize\"\n    (page)=\"onPaginateChange($event)\"\n  >\n  </mat-paginator>\n\n  <div class=\"center-spinner\" *ngIf=\"loading$ | async\">\n    <mat-progress-spinner diameter=\"50\" mode=\"indeterminate\">\n    </mat-progress-spinner>\n  </div>\n</div>\n","import { BookDetailsComponent } from './book-details/book-details.component';\nimport {\n  searchLoading,\n  books,\n  totalItems,\n  lastQuery,\n} from './../../store/selectors/search.selectors';\nimport { searchBooks } from './../../store/actions/search.actions';\nimport { username } from './../../../../core/auth/store/auth.selectors';\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  OnDestroy,\n  OnInit,\n} from '@angular/core';\nimport { select, Store } from '@ngrx/store';\nimport { MatDialog } from '@angular/material/dialog';\nimport { addToWishlist } from '../../store/actions/wishlist.actions';\nimport { shareReplay, take, takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\n\n@Component({\n  selector: 'app-search',\n  templateUrl: './search.component.html',\n  styleUrls: ['./search.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class SearchComponent implements OnInit, OnDestroy {\n  username$;\n  loading$;\n  books$;\n  totalItems$;\n  lastQuery;\n\n  destroy$ = new Subject();\n\n  constructor(private store: Store, private dialog: MatDialog) {}\n\n  ngOnInit(): void {\n    this.username$ = this.store.select(username);\n    this.loading$ = this.store.select(searchLoading);\n    this.books$ = this.store.select(books);\n    this.totalItems$ = this.store.select(totalItems);\n\n    this.store\n      .pipe(select(lastQuery), takeUntil(this.destroy$))\n      .subscribe((lastQuery) => {\n        this.lastQuery = lastQuery;\n      });\n  }\n\n  onSearchInputChanged($event) {\n    this.searchBooks($event, 0);\n  }\n\n  onPageChange($event: { pageIndex: number; pageSize: number }) {\n    const startIndex = $event.pageIndex * $event.pageSize;\n    this.searchBooks(this.lastQuery, startIndex);\n  }\n\n  searchBooks(query, startIndex) {\n    this.store.dispatch(searchBooks({ query: query, startIndex }));\n  }\n\n  onRowClicked($event) {\n    let dialogRef = this.dialog.open(BookDetailsComponent, {\n      data: $event,\n      width: '450px',\n      maxHeight: '450px',\n    });\n\n    dialogRef.afterClosed().subscribe((result) => {\n      if (result) {\n        this.store.dispatch(addToWishlist({ book: $event }));\n      }\n    });\n  }\n\n  ngOnDestroy(): void {\n    this.destroy$.next();\n  }\n}\n","<div class=\"container\">\n  <div class=\"row\">\n    <div class=\"col text-center\">\n      <h1>Welcome {{ username$ | async }}</h1>\n    </div>\n  </div>\n  <div class=\"row\">\n    <div class=\"col\">\n      <app-books-search-input\n        (inputChange)=\"onSearchInputChanged($event)\"\n      ></app-books-search-input>\n    </div>\n  </div>\n  <div class=\"row mt-5\">\n    <div class=\"col\">\n      <app-books-table\n        [books$]=\"books$\"\n        [loading$]=\"loading$\"\n        [totalItems$]=\"totalItems$\"\n        (pageChange)=\"onPageChange($event)\"\n        (rowClicked)=\"onRowClicked($event)\"\n      ></app-books-table>\n    </div>\n  </div>\n</div>\n","import { createFeatureSelector, createSelector } from '@ngrx/store';\nimport * as fromSearch from '../reducers/search.reducer';\n\nexport const selectSearchState = createFeatureSelector<fromSearch.State>(\n  fromSearch.searchFeatureKey\n);\n\nexport const searchLoading = createSelector(\n  selectSearchState,\n  (state) => state.loading\n);\n\nexport const books = createSelector(selectSearchState, (state) => state.books);\n\nexport const totalItems = createSelector(\n  selectSearchState,\n  (state) => state.totalItems\n);\n\nexport const lastQuery = createSelector(\n  selectSearchState,\n  (state) => state.lastQuery\n);\n"]}