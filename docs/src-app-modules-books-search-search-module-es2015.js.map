{"version":3,"sources":["./src/app/modules/books/search/search-routing.module.ts","./src/app/modules/books/search/search.module.ts","./src/app/modules/books/search/search/book-details/book-details.component.ts","./src/app/modules/books/search/search/book-details/book-details.component.html","./src/app/modules/books/search/search/books-search-input/books-search-input.component.ts","./src/app/modules/books/search/search/books-search-input/books-search-input.component.html","./src/app/modules/books/search/search/books-table/books-table.component.ts","./src/app/modules/books/search/search/books-table/books-table.component.html","./src/app/modules/books/search/search/search.component.ts","./src/app/modules/books/search/search/search.component.html","./src/app/modules/books/store/selectors/search.selectors.ts"],"names":[],"mappings":"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","file":"src-app-modules-books-search-search-module-es2015.js","sourcesContent":["import { SearchComponent } from './search/search.component';\r\nimport { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: SearchComponent,\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class SearchRoutingModule {}\r\n","import { MatCoreModule } from './../../../shared/mat-core/mat-core.module';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { SearchRoutingModule } from './search-routing.module';\r\nimport { SearchComponent } from './search/search.component';\r\nimport { BooksSearchInputComponent } from './search/books-search-input/books-search-input.component';\r\nimport { BooksTableComponent } from './search/books-table/books-table.component';\r\nimport { BookDetailsComponent } from './search/book-details/book-details.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    BooksTableComponent,\r\n    BooksSearchInputComponent,\r\n    SearchComponent,\r\n    BookDetailsComponent,\r\n  ],\r\n  imports: [CommonModule, SearchRoutingModule, MatCoreModule],\r\n  entryComponents: [BookDetailsComponent],\r\n})\r\nexport class SearchModule {}\r\n","import { Component, Inject, OnInit } from '@angular/core';\r\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { Book } from 'src/app/core/models/book.model';\r\n\r\n@Component({\r\n  templateUrl: './book-details.component.html',\r\n  styleUrls: ['./book-details.component.scss'],\r\n})\r\nexport class BookDetailsComponent implements OnInit {\r\n  book: Book;\r\n\r\n  constructor(@Inject(MAT_DIALOG_DATA) data: Book) {\r\n    this.book = data;\r\n  }\r\n\r\n  ngOnInit(): void {}\r\n}\r\n","<h1 mat-dialog-title>{{ book.title }}</h1>\r\n<div mat-dialog-content style=\"overflow: hidden\">\r\n  <div class=\"row\">\r\n    <div class=\"col-auto\"><img [src]=\"book.thumbnailUrl\" /></div>\r\n    <div class=\"col\">{{ book.description }}</div>\r\n  </div>\r\n</div>\r\n<div mat-dialog-actions>\r\n  <button mat-button [mat-dialog-close]=\"false\">Close</button>\r\n  <button mat-button [mat-dialog-close]=\"true\" cdkFocusInitial>\r\n    Add to wishlist\r\n  </button>\r\n</div>\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  ViewChild,\r\n  ElementRef,\r\n  AfterViewInit,\r\n  Output,\r\n  OnDestroy,\r\n  EventEmitter,\r\n  Input,\r\n} from '@angular/core';\r\nimport { fromEvent } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-books-search-input',\r\n  templateUrl: './books-search-input.component.html',\r\n  styleUrls: ['./books-search-input.component.scss'],\r\n})\r\nexport class BooksSearchInputComponent\r\n  implements OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('input') inputEl: ElementRef;\r\n\r\n  @Output() inputChange = new EventEmitter<string>();\r\n\r\n  constructor() {}\r\n\r\n  ngOnInit(): void {}\r\n\r\n  ngAfterViewInit(): void {\r\n    fromEvent(this.inputEl.nativeElement, 'input')\r\n      .pipe(\r\n        map((x: any) => {\r\n          const value = this.inputEl.nativeElement.value;\r\n          this.inputChange.emit(value);\r\n        })\r\n      )\r\n      .subscribe(() => {});\r\n  }\r\n\r\n  ngOnDestroy(): void {}\r\n}\r\n","<mat-form-field>\r\n  <input #input matInput placeholder=\"Search books\" />\r\n</mat-form-field>\r\n","import { Observable, Subject } from 'rxjs';\r\nimport {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { Book } from 'src/app/core/models/book.model';\r\nimport { MatPaginator } from '@angular/material/paginator';\r\nimport { takeUntil } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-books-table',\r\n  templateUrl: './books-table.component.html',\r\n  styleUrls: ['./books-table.component.scss'],\r\n})\r\nexport class BooksTableComponent implements OnInit, OnDestroy {\r\n  @Input() books$: Observable<Book>;\r\n  @Input() totalItems$: Observable<number>;\r\n  @Input() loading$: Observable<boolean>;\r\n  @Output() pageChange = new EventEmitter<{\r\n    pageIndex: number;\r\n    pageSize: number;\r\n  }>();\r\n  @Output() rowClicked = new EventEmitter<Book>();\r\n\r\n  totalItems = 0;\r\n\r\n  // Table properties\r\n  columns = ['title'];\r\n  pageSize = 20;\r\n  @ViewChild('paginator') paginator: MatPaginator;\r\n\r\n  destroy$ = new Subject();\r\n\r\n  constructor() {}\r\n\r\n  ngOnInit(): void {\r\n    // Reset paginator on new query\r\n    this.totalItems$.pipe(takeUntil(this.destroy$)).subscribe((x) => {\r\n      if (this.paginator) {\r\n        this.paginator.firstPage();\r\n      }\r\n\r\n      this.totalItems = x;\r\n    });\r\n  }\r\n\r\n  onPaginateChange($event) {\r\n    this.pageChange.emit({\r\n      pageIndex: $event.pageIndex,\r\n      pageSize: $event.pageSize,\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.destroy$.next();\r\n  }\r\n}\r\n","<div div class=\"mat-elevation-z8\">\r\n  <table mat-table [dataSource]=\"books$ | async\">\r\n    <ng-container matColumnDef=\"title\">\r\n      <th mat-header-cell *matHeaderCellDef>Title</th>\r\n      <td mat-cell *matCellDef=\"let element\">{{ element.title }}</td>\r\n    </ng-container>\r\n\r\n    <tr mat-header-row *matHeaderRowDef=\"columns\"></tr>\r\n    <tr\r\n      class=\"clickable-row\"\r\n      mat-row\r\n      *matRowDef=\"let row; columns: columns\"\r\n      (click)=\"rowClicked.emit(row)\"\r\n    ></tr>\r\n  </table>\r\n  <mat-paginator\r\n    #paginator\r\n    [length]=\"totalItems\"\r\n    [pageSize]=\"pageSize\"\r\n    (page)=\"onPaginateChange($event)\"\r\n  >\r\n  </mat-paginator>\r\n\r\n  <div class=\"center-spinner\" *ngIf=\"loading$ | async\">\r\n    <mat-progress-spinner diameter=\"50\" mode=\"indeterminate\">\r\n    </mat-progress-spinner>\r\n  </div>\r\n</div>\r\n","import { BookDetailsComponent } from './book-details/book-details.component';\r\nimport {\r\n  searchLoading,\r\n  books,\r\n  totalItems,\r\n  lastQuery,\r\n} from './../../store/selectors/search.selectors';\r\nimport { searchBooks } from './../../store/actions/search.actions';\r\nimport { username } from './../../../../core/auth/store/auth.selectors';\r\nimport {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  OnDestroy,\r\n  OnInit,\r\n} from '@angular/core';\r\nimport { select, Store } from '@ngrx/store';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { addToWishlist } from '../../store/actions/wishlist.actions';\r\nimport { shareReplay, take, takeUntil } from 'rxjs/operators';\r\nimport { Subject } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-search',\r\n  templateUrl: './search.component.html',\r\n  styleUrls: ['./search.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class SearchComponent implements OnInit, OnDestroy {\r\n  username$;\r\n  loading$;\r\n  books$;\r\n  totalItems$;\r\n  lastQuery;\r\n\r\n  destroy$ = new Subject();\r\n\r\n  constructor(private store: Store, private dialog: MatDialog) {}\r\n\r\n  ngOnInit(): void {\r\n    this.username$ = this.store.select(username);\r\n    this.loading$ = this.store.select(searchLoading);\r\n    this.books$ = this.store.select(books);\r\n    this.totalItems$ = this.store.select(totalItems);\r\n\r\n    this.store\r\n      .pipe(select(lastQuery), takeUntil(this.destroy$))\r\n      .subscribe((lastQuery) => {\r\n        this.lastQuery = lastQuery;\r\n      });\r\n  }\r\n\r\n  onSearchInputChanged($event) {\r\n    this.searchBooks($event, 0);\r\n  }\r\n\r\n  onPageChange($event: { pageIndex: number; pageSize: number }) {\r\n    const startIndex = $event.pageIndex * $event.pageSize;\r\n    this.searchBooks(this.lastQuery, startIndex);\r\n  }\r\n\r\n  searchBooks(query, startIndex) {\r\n    this.store.dispatch(searchBooks({ query: query, startIndex }));\r\n  }\r\n\r\n  onRowClicked($event) {\r\n    let dialogRef = this.dialog.open(BookDetailsComponent, {\r\n      data: $event,\r\n      width: '450px',\r\n      maxHeight: '450px',\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe((result) => {\r\n      if (result) {\r\n        this.store.dispatch(addToWishlist({ book: $event }));\r\n      }\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.destroy$.next();\r\n  }\r\n}\r\n","<div class=\"container\">\r\n  <div class=\"row\">\r\n    <div class=\"col text-center\">\r\n      <h1>Welcome {{ username$ | async }}</h1>\r\n    </div>\r\n  </div>\r\n  <div class=\"row\">\r\n    <div class=\"col\">\r\n      <app-books-search-input\r\n        (inputChange)=\"onSearchInputChanged($event)\"\r\n      ></app-books-search-input>\r\n    </div>\r\n  </div>\r\n  <div class=\"row mt-5\">\r\n    <div class=\"col\">\r\n      <app-books-table\r\n        [books$]=\"books$\"\r\n        [loading$]=\"loading$\"\r\n        [totalItems$]=\"totalItems$\"\r\n        (pageChange)=\"onPageChange($event)\"\r\n        (rowClicked)=\"onRowClicked($event)\"\r\n      ></app-books-table>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { createFeatureSelector, createSelector } from '@ngrx/store';\r\nimport * as fromSearch from '../reducers/search.reducer';\r\n\r\nexport const selectSearchState = createFeatureSelector<fromSearch.State>(\r\n  fromSearch.searchFeatureKey\r\n);\r\n\r\nexport const searchLoading = createSelector(\r\n  selectSearchState,\r\n  (state) => state.loading\r\n);\r\n\r\nexport const books = createSelector(selectSearchState, (state) => state.books);\r\n\r\nexport const totalItems = createSelector(\r\n  selectSearchState,\r\n  (state) => state.totalItems\r\n);\r\n\r\nexport const lastQuery = createSelector(\r\n  selectSearchState,\r\n  (state) => state.lastQuery\r\n);\r\n"],"sourceRoot":"webpack:///"}