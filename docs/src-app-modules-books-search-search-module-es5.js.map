{"version":3,"sources":["webpack:///src/app/modules/books/search/search-routing.module.ts","webpack:///src/app/modules/books/search/search.module.ts","webpack:///src/app/modules/books/search/search/book-details/book-details.component.ts","webpack:///src/app/modules/books/search/search/book-details/book-details.component.html","webpack:///src/app/modules/books/search/search/books-search-input/books-search-input.component.ts","webpack:///src/app/modules/books/search/search/books-search-input/books-search-input.component.html","webpack:///src/app/modules/books/search/search/books-table/books-table.component.ts","webpack:///src/app/modules/books/search/search/books-table/books-table.component.html","webpack:///src/app/modules/books/search/search/search.component.ts","webpack:///src/app/modules/books/search/search/search.component.html","webpack:///src/app/modules/books/store/selectors/search.selectors.ts"],"names":["routes","path","component","SearchRoutingModule","forChild","imports","exports","SearchModule","declarations","entryComponents","BookDetailsComponent","data","book","templateUrl","styleUrls","BooksSearchInputComponent","inputChange","inputEl","nativeElement","pipe","x","value","emit","subscribe","selector","rowClicked","BooksTableComponent","pageChange","totalItems","columns","pageSize","destroy$","totalItems$","paginator","firstPage","$event","pageIndex","next","onPaginateChange","SearchComponent","store","dialog","username$","select","loading$","books$","lastQuery","searchBooks","startIndex","query","dispatch","dialogRef","open","width","maxHeight","afterClosed","result","onSearchInputChanged","onPageChange","onRowClicked","changeDetection","OnPush","selectSearchState","searchLoading","state","loading","books"],"mappings":"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","file":"src-app-modules-books-search-search-module-es5.js","sourcesContent":["import { SearchComponent } from './search/search.component';\r\nimport { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: SearchComponent,\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class SearchRoutingModule {}\r\n","import { MatCoreModule } from './../../../shared/mat-core/mat-core.module';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { SearchRoutingModule } from './search-routing.module';\r\nimport { SearchComponent } from './search/search.component';\r\nimport { BooksSearchInputComponent } from './search/books-search-input/books-search-input.component';\r\nimport { BooksTableComponent } from './search/books-table/books-table.component';\r\nimport { BookDetailsComponent } from './search/book-details/book-details.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    BooksTableComponent,\r\n    BooksSearchInputComponent,\r\n    SearchComponent,\r\n    BookDetailsComponent,\r\n  ],\r\n  imports: [CommonModule, SearchRoutingModule, MatCoreModule],\r\n  entryComponents: [BookDetailsComponent],\r\n})\r\nexport class SearchModule {}\r\n","import { Component, Inject, OnInit } from '@angular/core';\r\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { Book } from 'src/app/core/models/book.model';\r\n\r\n@Component({\r\n  templateUrl: './book-details.component.html',\r\n  styleUrls: ['./book-details.component.scss'],\r\n})\r\nexport class BookDetailsComponent implements OnInit {\r\n  book: Book;\r\n\r\n  constructor(@Inject(MAT_DIALOG_DATA) data: Book) {\r\n    this.book = data;\r\n  }\r\n\r\n  ngOnInit(): void {}\r\n}\r\n","<h1 mat-dialog-title>{{ book.title }}</h1>\r\n<div mat-dialog-content style=\"overflow: hidden\">\r\n  <div class=\"row\">\r\n    <div class=\"col-auto\"><img [src]=\"book.thumbnailUrl\" /></div>\r\n    <div class=\"col\">{{ book.description }}</div>\r\n  </div>\r\n</div>\r\n<div mat-dialog-actions>\r\n  <button mat-button [mat-dialog-close]=\"false\">Close</button>\r\n  <button mat-button [mat-dialog-close]=\"true\" cdkFocusInitial>\r\n    Add to wishlist\r\n  </button>\r\n</div>\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  ViewChild,\r\n  ElementRef,\r\n  AfterViewInit,\r\n  Output,\r\n  OnDestroy,\r\n  EventEmitter,\r\n  Input,\r\n} from '@angular/core';\r\nimport { fromEvent } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-books-search-input',\r\n  templateUrl: './books-search-input.component.html',\r\n  styleUrls: ['./books-search-input.component.scss'],\r\n})\r\nexport class BooksSearchInputComponent\r\n  implements OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('input') inputEl: ElementRef;\r\n\r\n  @Output() inputChange = new EventEmitter<string>();\r\n\r\n  constructor() {}\r\n\r\n  ngOnInit(): void {}\r\n\r\n  ngAfterViewInit(): void {\r\n    fromEvent(this.inputEl.nativeElement, 'input')\r\n      .pipe(\r\n        map((x: any) => {\r\n          const value = this.inputEl.nativeElement.value;\r\n          this.inputChange.emit(value);\r\n        })\r\n      )\r\n      .subscribe(() => {});\r\n  }\r\n\r\n  ngOnDestroy(): void {}\r\n}\r\n","<mat-form-field>\r\n  <input #input matInput placeholder=\"Search books\" />\r\n</mat-form-field>\r\n","import { Observable, Subject } from 'rxjs';\r\nimport {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { Book } from 'src/app/core/models/book.model';\r\nimport { MatPaginator } from '@angular/material/paginator';\r\nimport { takeUntil } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-books-table',\r\n  templateUrl: './books-table.component.html',\r\n  styleUrls: ['./books-table.component.scss'],\r\n})\r\nexport class BooksTableComponent implements OnInit, OnDestroy {\r\n  @Input() books$: Observable<Book>;\r\n  @Input() totalItems$: Observable<number>;\r\n  @Input() loading$: Observable<boolean>;\r\n  @Output() pageChange = new EventEmitter<{\r\n    pageIndex: number;\r\n    pageSize: number;\r\n  }>();\r\n  @Output() rowClicked = new EventEmitter<Book>();\r\n\r\n  totalItems = 0;\r\n\r\n  // Table properties\r\n  columns = ['title'];\r\n  pageSize = 20;\r\n  @ViewChild('paginator') paginator: MatPaginator;\r\n\r\n  destroy$ = new Subject();\r\n\r\n  constructor() {}\r\n\r\n  ngOnInit(): void {\r\n    // Reset paginator on new query\r\n    this.totalItems$.pipe(takeUntil(this.destroy$)).subscribe((x) => {\r\n      if (this.paginator) {\r\n        this.paginator.firstPage();\r\n      }\r\n\r\n      this.totalItems = x;\r\n    });\r\n  }\r\n\r\n  onPaginateChange($event) {\r\n    this.pageChange.emit({\r\n      pageIndex: $event.pageIndex,\r\n      pageSize: $event.pageSize,\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.destroy$.next();\r\n  }\r\n}\r\n","<div div class=\"mat-elevation-z8\">\r\n  <table mat-table [dataSource]=\"books$ | async\">\r\n    <ng-container matColumnDef=\"title\">\r\n      <th mat-header-cell *matHeaderCellDef>Title</th>\r\n      <td mat-cell *matCellDef=\"let element\">{{ element.title }}</td>\r\n    </ng-container>\r\n\r\n    <tr mat-header-row *matHeaderRowDef=\"columns\"></tr>\r\n    <tr\r\n      class=\"clickable-row\"\r\n      mat-row\r\n      *matRowDef=\"let row; columns: columns\"\r\n      (click)=\"rowClicked.emit(row)\"\r\n    ></tr>\r\n  </table>\r\n  <mat-paginator\r\n    #paginator\r\n    [length]=\"totalItems\"\r\n    [pageSize]=\"pageSize\"\r\n    (page)=\"onPaginateChange($event)\"\r\n  >\r\n  </mat-paginator>\r\n\r\n  <div class=\"center-spinner\" *ngIf=\"loading$ | async\">\r\n    <mat-progress-spinner diameter=\"50\" mode=\"indeterminate\">\r\n    </mat-progress-spinner>\r\n  </div>\r\n</div>\r\n","import { BookDetailsComponent } from './book-details/book-details.component';\r\nimport {\r\n  searchLoading,\r\n  books,\r\n  totalItems,\r\n  lastQuery,\r\n} from './../../store/selectors/search.selectors';\r\nimport { searchBooks } from './../../store/actions/search.actions';\r\nimport { username } from './../../../../core/auth/store/auth.selectors';\r\nimport {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  OnDestroy,\r\n  OnInit,\r\n} from '@angular/core';\r\nimport { select, Store } from '@ngrx/store';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { addToWishlist } from '../../store/actions/wishlist.actions';\r\nimport { shareReplay, take, takeUntil } from 'rxjs/operators';\r\nimport { Subject } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-search',\r\n  templateUrl: './search.component.html',\r\n  styleUrls: ['./search.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class SearchComponent implements OnInit, OnDestroy {\r\n  username$;\r\n  loading$;\r\n  books$;\r\n  totalItems$;\r\n  lastQuery;\r\n\r\n  destroy$ = new Subject();\r\n\r\n  constructor(private store: Store, private dialog: MatDialog) {}\r\n\r\n  ngOnInit(): void {\r\n    this.username$ = this.store.select(username);\r\n    this.loading$ = this.store.select(searchLoading);\r\n    this.books$ = this.store.select(books);\r\n    this.totalItems$ = this.store.select(totalItems);\r\n\r\n    this.store\r\n      .pipe(select(lastQuery), takeUntil(this.destroy$))\r\n      .subscribe((lastQuery) => {\r\n        this.lastQuery = lastQuery;\r\n      });\r\n  }\r\n\r\n  onSearchInputChanged($event) {\r\n    this.searchBooks($event, 0);\r\n  }\r\n\r\n  onPageChange($event: { pageIndex: number; pageSize: number }) {\r\n    const startIndex = $event.pageIndex * $event.pageSize;\r\n    this.searchBooks(this.lastQuery, startIndex);\r\n  }\r\n\r\n  searchBooks(query, startIndex) {\r\n    this.store.dispatch(searchBooks({ query: query, startIndex }));\r\n  }\r\n\r\n  onRowClicked($event) {\r\n    let dialogRef = this.dialog.open(BookDetailsComponent, {\r\n      data: $event,\r\n      width: '450px',\r\n      maxHeight: '450px',\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe((result) => {\r\n      if (result) {\r\n        this.store.dispatch(addToWishlist({ book: $event }));\r\n      }\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.destroy$.next();\r\n  }\r\n}\r\n","<div class=\"container\">\r\n  <div class=\"row\">\r\n    <div class=\"col text-center\">\r\n      <h1>Welcome {{ username$ | async }}</h1>\r\n    </div>\r\n  </div>\r\n  <div class=\"row\">\r\n    <div class=\"col\">\r\n      <app-books-search-input\r\n        (inputChange)=\"onSearchInputChanged($event)\"\r\n      ></app-books-search-input>\r\n    </div>\r\n  </div>\r\n  <div class=\"row mt-5\">\r\n    <div class=\"col\">\r\n      <app-books-table\r\n        [books$]=\"books$\"\r\n        [loading$]=\"loading$\"\r\n        [totalItems$]=\"totalItems$\"\r\n        (pageChange)=\"onPageChange($event)\"\r\n        (rowClicked)=\"onRowClicked($event)\"\r\n      ></app-books-table>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { createFeatureSelector, createSelector } from '@ngrx/store';\r\nimport * as fromSearch from '../reducers/search.reducer';\r\n\r\nexport const selectSearchState = createFeatureSelector<fromSearch.State>(\r\n  fromSearch.searchFeatureKey\r\n);\r\n\r\nexport const searchLoading = createSelector(\r\n  selectSearchState,\r\n  (state) => state.loading\r\n);\r\n\r\nexport const books = createSelector(selectSearchState, (state) => state.books);\r\n\r\nexport const totalItems = createSelector(\r\n  selectSearchState,\r\n  (state) => state.totalItems\r\n);\r\n\r\nexport const lastQuery = createSelector(\r\n  selectSearchState,\r\n  (state) => state.lastQuery\r\n);\r\n"]}